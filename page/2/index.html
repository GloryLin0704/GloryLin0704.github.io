<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="努力活成你喜欢的样子">
<meta property="og:type" content="website">
<meta property="og:title" content="GloryLin">
<meta property="og:url" content="https://GloryLin0704.github.io/page/2/index.html">
<meta property="og:site_name" content="GloryLin">
<meta property="og:description" content="努力活成你喜欢的样子">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="GloryLin">
<meta name="twitter:description" content="努力活成你喜欢的样子">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://GloryLin0704.github.io/page/2/"/>





  <title> GloryLin </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">GloryLin</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GloryLin0704.github.io/2017/09/19/mongoose/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RY Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://ots4cfy06.bkt.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GloryLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/19/mongoose/" itemprop="url">
                  Mongoose才是正确答案
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-19T21:25:36+08:00">
                2017-09-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/09/19/mongoose/" class="leancloud_visitors" data-flag-title="Mongoose才是正确答案">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>mongoose是mongo衍生而来，比mongo更方便，我认为主要是体现在可以将表的信息封装起来</p>
</blockquote>
<p><a href="http://www.cnblogs.com/zhongweiv/p/mongoose.html#node_intro" target="_blank" rel="external">http://www.cnblogs.com/zhongweiv/p/mongoose.html#node_intro</a></p>
<ul>
<li>这是比较通俗易懂的教程，但被红莲鄙视了！所以此处写的是从红莲博客中关于mongoose代码领悟到一些皮毛</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install mongoose --save</div></pre></td></tr></table></figure>
<p>在当前文件夹中安装依赖</p>
<ul>
<li>由于是用到了封装，所以需要创建一个文件夹，db，这个文件夹的作用是将和数据库有关的操作都封装好，在以后的程序中就可以直接调用了。</li>
</ul>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/09/19/mongoose/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GloryLin0704.github.io/2017/08/12/summary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RY Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://ots4cfy06.bkt.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GloryLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/12/summary/" itemprop="url">
                  Summer Summary
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-12T23:40:35+08:00">
                2017-08-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/08/12/summary/" class="leancloud_visitors" data-flag-title="Summer Summary">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="后劲有点大"><a href="#后劲有点大" class="headerlink" title="后劲有点大"></a>后劲有点大</h1><p>在写这篇总结的时候，我偷偷跑去看了他们几个总结，逸恬把我床照作为结尾，我……；瀚程的槽点有点多；健豪的逼格超高，还带音乐，炫得飞起来；浩楠估计和我差不多……</p>
<ul>
<li>话说在培训开始前，就很期待未来一个月会是怎样；果然，很值，大礼包！又胖了一圈。当然也在粤南红*学了些硬家伙，什么翻墙呀，搭服务器呀，都是装逼利器，这个月过得比过去一年还有价值，和大家在一起吹空调的日子过得就是快，回来几天了还没缓过来，毕竟热得飞起来。这个月的外卖比我一年吃得还多，诸位都是有钱人，还有总是见不着人的隐藏富婆momo；汉城说我和婉婷天天开车，这我华为荣耀就不服了，诸位都是一等一的老师傅，开起车来莫名其妙上180的；不得不说的还有我们外卖偶像男子天团，雷打不动的一饭三人组，一饭宿舍路上不孤单！讲真，大家中午不睡觉真的不妥，干不到大四的。</li>
</ul>
<h1 id="顺德游"><a href="#顺德游" class="headerlink" title="顺德游"></a>顺德游</h1><p>高铁没有想象中那样炫，人又多又挤，差评！本次顺德游最大遗憾是没有去到清晖园，回想一下，好像去顺德就是吃了两三餐就回来了，什么都没有做……当然，除了晚上偷偷给郁卓过生日，我都感觉这B是知道了的，假意不知道，还有就是被逸恬加了一副扑克的UNO和狼人杀。哇，我生日也快到了呀，我也想要惊喜，我不要字符串，我会假装什么都不知道的！哇，越写越觉得亏耶，顺德这趟感觉什么回忆杀都没，想写点啥都写不了，电影是回科中看的，连最后的合照都是在商中的KFC，亏了亏了……</p>
<h1 id="工作室日常"><a href="#工作室日常" class="headerlink" title="工作室日常"></a>工作室日常</h1><p>朝九晚十的生活是挺有趣的，有好几个早上是不用闹钟七点多就醒了的，叫醒我的不是闹钟，不是梦想，也不是没打完的码，是尿急！在工作室最有趣的是能和大家共(yi)同(qi)学(chi)习(shi)、共(chu)同(men)进(zuo)步(guai)，前两个星期学习的力度还行，到第三个星期我就感觉有些懵逼不知道做些什么了，不是都懂了，是不知道从哪开始学，直至第四周开始做DailyCss，任务还不算重，和浩楠分工三四天就做完了，主要是忙对接，先是我和浩楠对接，然后和前端对接，边对接边测试，虽然最后没对接完。回来的时候，带了本书回来，原本计划着回来再接着学习socket.io的，现在看来，估计开学了还没开始……</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GloryLin0704.github.io/2017/08/05/last/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RY Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://ots4cfy06.bkt.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GloryLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/05/last/" itemprop="url">
                  DailyCss
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-05T22:41:01+08:00">
                2017-08-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/08/05/last/" class="leancloud_visitors" data-flag-title="DailyCss">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="难点：置顶评论、数据库查询多重条件查询"><a href="#难点：置顶评论、数据库查询多重条件查询" class="headerlink" title="难点：置顶评论、数据库查询多重条件查询"></a>难点：置顶评论、数据库查询多重条件查询</h2><blockquote>
<p>查询Mongodb:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="number">1.</span> <span class="keyword">var</span> whereStr = &#123;<span class="string">"username"</span>:&#123;<span class="attr">$gte</span>:<span class="string">""</span>&#125;&#125;;</div><div class="line">    <span class="comment">//匹配&gt;=""的username，即所有存在的username</span></div><div class="line"><span class="number">2.</span> <span class="keyword">var</span> whereStr = &#123;<span class="string">"id"</span>:id&#125;</div><div class="line">    <span class="comment">//简单的条件查询</span></div><div class="line"><span class="number">3.</span> <span class="keyword">var</span> whereStr = &#123;<span class="string">"id"</span>:id, <span class="string">"username"</span>:username&#125;</div><div class="line">   <span class="keyword">var</span> updateStr = &#123;<span class="attr">$set</span>: &#123;<span class="string">"status"</span>:<span class="string">"0"</span>&#125;&#125;;</div><div class="line">   <span class="keyword">var</span> updateStr = &#123;<span class="attr">$set</span>: &#123;<span class="string">"time"</span>:time, <span class="string">"thing"</span>:thing&#125;&#125;;</div><div class="line">    <span class="comment">//查询符合条件的数据，更新一个数据或多个数据</span></div><div class="line"><span class="number">4.</span> <span class="keyword">var</span> whereStr = &#123;<span class="string">"$or"</span>:[&#123;<span class="string">"username"</span>:<span class="string">"zxc110"</span>&#125;, &#123;<span class="string">"username"</span>:<span class="string">"zxc111"</span>&#125;]&#125;</div><div class="line">    <span class="comment">//</span></div></pre></td></tr></table></figure></p>
<p>跨域访问<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">app.all(<span class="string">'*'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">    res.header(<span class="string">"Access-Control-Allow-Origin"</span>, <span class="string">"*"</span>);</div><div class="line">    res.header(<span class="string">"Access-Control-Allow-Headers"</span>, <span class="string">"X-Requested-With"</span>);</div><div class="line">    res.header(<span class="string">"Access-Control-Allow-Methods"</span>,<span class="string">"PUT,POST,GET,DELETE,OPTIONS"</span>);</div><div class="line">    res.header(<span class="string">"X-Powered-By"</span>,<span class="string">' 3.2.1'</span>)</div><div class="line">    res.header(<span class="string">"Content-Type"</span>, <span class="string">"application/json;charset=utf-8"</span>);</div><div class="line">    next();</div><div class="line">&#125;);</div><div class="line">    <span class="comment">//实现跨域访问，可以让请求来自不同的域，需要写在所有绑定的路由前</span></div></pre></td></tr></table></figure></p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GloryLin0704.github.io/2017/07/28/19/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RY Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://ots4cfy06.bkt.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GloryLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/28/19/" itemprop="url">
                  19th Day
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-28T15:15:57+08:00">
                2017-07-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/07/28/19/" class="leancloud_visitors" data-flag-title="19th Day">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="七牛qshell命令行"><a href="#七牛qshell命令行" class="headerlink" title="七牛qshell命令行"></a>七牛qshell命令行</h1><blockquote>
<p>fput 以文件表单的方式上传一个文件<br>    qshell fput  &lt;七牛空间名称&gt;  &lt;保存的名称&gt;  &lt;本地文件路径&gt;<br>    $ qshell fput glory  qiniu.jpg  /Users/jemy/Documents/qiniu.jpg<br>delete 删除七牛的空间里的文件<br>    qshell delete <bucket>  <key><br>    $ qshell delete glory qiniu.mp4     </key></bucket></p>
<p>stat  查看七牛中文件的基本信息，名称、保存时间、HASH值、大小、MimeType<br>    qshell stat <bucket> <key>                                      $ qshell stat glory qiniu.png                </key></bucket></p>
<p>listbucket  获取七牛空间里的文件列表，并生成文件<br>    qshell listbucket <bucket> <listbucketresultfile><br>    $ qshell listbucket glory list.txt</listbucketresultfile></bucket></p>
<p>fetch 从互联网中获取一个资源并保存到七牛空间中,不设置key则名称是HASH值<br>    qshell fetch <remoteresourceurl> <bucket> [<key>]<br>    $ qshell fetch <a href="https://www.baidu.com/img/bdlogo.png" target="_blank" rel="external">https://www.baidu.com/img/bdlogo.png</a> glory bdlogo.png</key></bucket></remoteresourceurl></p>
<p>batchdelete 根据一个文件名列表来批量删除空间中的这些文件<br>    删除空间glory中的所有文件：<br>    $ qshell listbucket glory list.txt<br>    $ qshell batchdelete -force glory list.txt</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GloryLin0704.github.io/2017/07/28/18/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RY Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://ots4cfy06.bkt.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GloryLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/28/18/" itemprop="url">
                  18th Day
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-28T09:35:22+08:00">
                2017-07-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/07/28/18/" class="leancloud_visitors" data-flag-title="18th Day">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h1><blockquote>
<p>它作为可以将域名和IP地址相互映射的一个分布式数据库，能够使人更方便的访问互联网，而不用去记住能够被机器直接读取的IP数串</p>
<ul>
<li>A记录：又称IP指向，用户可以在此设置子域名并指向到自己的目标主机地址上，从而实现通过域名找到服务器。<br>说明：·指向的目标主机地址类型只能使用IP地址</li>
<li>C记录：通常称别名指向。可以为一个主机设置别名。比如设置test.mydomain.com，用来指向一个主机www.rddns.com那么以后就可以用test.mydomain.com来代替访问www.rddns.com了。<br>说明：CNAME的目标主机地址只能使用主机名，不能使用IP地址；·主机名前不能有任何其他前缀，如：<a href="http://等是不被允许的；·A记录优先于CNAME记录。即如果一个主机地址同时存在A记录和CNAME记录，则CNAME记录不生效。（C记录中的主机名可以由A记录得来，但请求的时候是用C记录绑定的域名请求，虽然与主机名请求的是同一个ip，但发送请求体不一样，缓解压力）" target="_blank" rel="external">http://等是不被允许的；·A记录优先于CNAME记录。即如果一个主机地址同时存在A记录和CNAME记录，则CNAME记录不生效。（C记录中的主机名可以由A记录得来，但请求的时候是用C记录绑定的域名请求，虽然与主机名请求的是同一个ip，但发送请求体不一样，缓解压力）</a></li></ul></blockquote>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/07/28/18/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GloryLin0704.github.io/2017/07/26/seventeenth/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RY Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://ots4cfy06.bkt.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GloryLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/26/seventeenth/" itemprop="url">
                  17th Day
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-26T14:33:57+08:00">
                2017-07-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/07/26/seventeenth/" class="leancloud_visitors" data-flag-title="17th Day">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h1><p>可以将域名与IP绑定，使访问该域名就可以解析为绑定IP（也可以绑定localhost的某个端口）</p>
<p>域名是唯一的，所以不存在多个域名指向同一个ip地址</p>
<p>在/usr/local/nginx/conf/vhost下，有xxx.conf文件，可以设置反向代理，vim打开一个conf编辑，添加：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">location /daily-css&#123;</div><div class="line">        proxy_pass http://localhost:8888;</div><div class="line">        <span class="comment">#proxt_pass http://google.com;</span></div><div class="line">        proxy_http_version 1.1;</div><div class="line">        proxy_set_header Upgrade <span class="variable">$http_upgrade</span>;</div><div class="line">        proxy_set_header Host <span class="variable">$host</span>;</div><div class="line">        proxy_cache_bypass <span class="variable">$http_upgrade</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>以上代码最有用的是proxy_pass xxxxxx(代理到的域名)</p>
<p>设置成功后需要重启lnmp nginx restart</p>
<p>当再次请求：原域名/daily-css，会跳到：代理域名/daily-css</p>
<h1 id="Centos7"><a href="#Centos7" class="headerlink" title="Centos7"></a>Centos7</h1><blockquote>
<p>服务器给定一个域名，相当于本地(localhost、127.0.0.1)，在/home/wwwroot 下可以看见与服务器ip绑定的域名，访问这些域名都会被DNS解析到绑定的ip去</p>
<p> 在这些域名里可以放页面，访问时xxx/a.html就可访问xxx域名下的a.html页面</p>
<p>通过 lnmp vhost add 可以添加新的域名到wwwroot中，但这些域名需要提前设定被解析到这个服务器的ip地址</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GloryLin0704.github.io/2017/07/26/sixteenth/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RY Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://ots4cfy06.bkt.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GloryLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/26/sixteenth/" itemprop="url">
                  16th Day
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-26T09:29:21+08:00">
                2017-07-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/07/26/sixteenth/" class="leancloud_visitors" data-flag-title="16th Day">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="搭建服务器"><a href="#搭建服务器" class="headerlink" title="搭建服务器"></a>搭建服务器</h1><blockquote>
<p>安装node运行环境</p>
</blockquote>
<pre><code>wget + 下载地址            下载某个文件

tar xvf + 文件名        解压某个文件

Ln  -s  原文件地址和名字  目标文件地址和命名     创建一个快捷方式

mv    ./文件名字  新文件名    修改文件名字

yum install screen      安装screen

新下载的临时文件放在usr/local/src中，这里是处理临时文件

将下载的压缩包解压后，将解压文件中移到usr/bin/的node放在usr/local/bin下，就可以在全局中运行

找到npm的具体位置在解压文件的lib/node_modules中，创建软链接在usr/local/bin下，那npm也可以在全局中用
</code></pre>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/07/26/sixteenth/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GloryLin0704.github.io/2017/07/24/fifteenth/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RY Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://ots4cfy06.bkt.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GloryLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/24/fifteenth/" itemprop="url">
                  15th Day
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-24T21:32:12+08:00">
                2017-07-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/07/24/fifteenth/" class="leancloud_visitors" data-flag-title="15th Day">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="Token"><a href="#Token" class="headerlink" title="Token"></a>Token</h1><h2 id="传统的认证系统"><a href="#传统的认证系统" class="headerlink" title="传统的认证系统"></a>传统的认证系统</h2><blockquote>
<p>1.用户在登录域输入 用户名 和 密码 ，然后点击 登录 ；</p>
<p>2.请求发送之后，通过在后端查询数据库验证用户的合法性。如果请求有效，使用在数据库得到的信息创建一个 session，然后在响应头信息中返回这个 session 的信息，目的是把这个 session ID 存储到浏览器中；</p>
<p>3.在访问应用中受限制的后端服务器时提供这个 session 信息；</p>
<p>4.如果 session 信息有效，允许用户访问受限制的后端服务器，并且把渲染好的 HTML 内容返回。</p>
</blockquote>
<h3 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h3><blockquote>
<p>在移动应用上 session 和 cookie 行不通。你无法与移动终端共享服务器创建的 session 和 cookie。</p>
<p>在这个应用中，渲染好的 HTML 被返回。但在移动端，你需要包含一些类似 JSON 或者 XML 的东西包含在响应中。</p>
</blockquote>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/07/24/fifteenth/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GloryLin0704.github.io/2017/07/21/twelve/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RY Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://ots4cfy06.bkt.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GloryLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/21/twelve/" itemprop="url">
                  12th Day
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-21T20:08:49+08:00">
                2017-07-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/07/21/twelve/" class="leancloud_visitors" data-flag-title="12th Day">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h1 id="代码改进"><a href="#代码改进" class="headerlink" title="代码改进"></a>代码改进</h1><blockquote>
<ul>
<li>将代码的路由都加上api，统一api,该api下都是处理数据的路由</li>
<li>由GET发送的请求都会将该form的内容作为参数加到url中</li>
<li>在数据库找到的结果都会以对象的形式返回到一个数组里，所以，对数据进行指定的搜索，想要输出就传入result[0].xxx</li>
<li>由于在查询数据库的时候如果没有这个属性的名字，返回的是undefined，无法输入，所以这时候需要过滤掉，Object.keys(result).length === 0，统计result对象的个数，如果是0就是undefined</li>
</ul>
<hr>
<h2 id="分页"><a href="#分页" class="headerlink" title="分页"></a>分页</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"http://localhost:3000/api/list"</span> <span class="attr">method</span>=<span class="string">"GET"</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"page"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"page"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div></pre></td></tr></table></figure>
<p>在page框中输入的页数会作为参数添加到<a href="http://localhost:3000/api/list中，如：http://localhost:3000/api/list？page=1" target="_blank" rel="external">http://localhost:3000/api/list中，如：http://localhost:3000/api/list？page=1</a></p>
</blockquote>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/07/21/twelve/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://GloryLin0704.github.io/2017/07/21/eleven/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="RY Lin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://ots4cfy06.bkt.clouddn.com/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GloryLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/21/eleven/" itemprop="url">
                  11th Day
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-21T09:15:22+08:00">
                2017-07-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/07/21/eleven/" class="leancloud_visitors" data-flag-title="11th Day">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="异步的原理："><a href="#异步的原理：" class="headerlink" title="异步的原理："></a>异步的原理：</h1><blockquote>
<ul>
<li>在每次执行函数的时候，给该函数传入一个callback（回调函数），在这个函数执行完了之后会执行，但不知道具体的执行时间，这是不可测的。<ul>
<li>异步是将回调函数加到队列里，按函数执行顺序加入，等编译器觉得时候合适了就调用，所以回调的执行是有顺序的，当前函数没执行完的时候是不会执行回调函数的</li>
<li>同步的缺点是当前函数不执行完是不会执行下一个函数，如果设置了一个死循环，那这个网页就会卡死，接下来的所有操作都没有用</li>
<li>不可以调用回调函数里返回的值，因为找不到这个值在哪，什么时候会形成</li>
</ul>
</li>
</ul>
</blockquote>
<h1 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h1><blockquote>
<ul>
<li>JSON是JS原生的，所以使用十分方便</li>
<li>后台将数据访问接受后，通过res.json( {code:xxx, data:xxx, msg:xxx} )返回到前端页面，让前端处理</li>
</ul>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="built_in">JSON</span>.stringify(&#123;<span class="attr">name</span>:<span class="string">"123"</span>,<span class="attr">age</span>:<span class="number">12</span>&#125;);</div><div class="line">=&gt; <span class="string">'&#123;"name":"123","age":12&#125;'</span></div><div class="line"><span class="comment">//将对象解析为字符串</span></div><div class="line"><span class="built_in">JSON</span>.parse(a);</div><div class="line">=&gt; <span class="built_in">Object</span> &#123;<span class="attr">name</span>: <span class="string">"123"</span>, <span class="attr">age</span>: <span class="number">12</span>&#125;</div><div class="line"><span class="comment">//将字符串转化为对象，把字符串在JSON.parse中调用必须严格按照转化程字符串的格式输入：JSON.parse('&#123;"name":"123","age":12&#125;')</span></div></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>对后台而言，JSON中使用的是将数据返回给前端:res.json( { } )，将前端发来的数据解析：JSON.parse( )、JSON.stringify( )</li>
</ul>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://ots4cfy06.bkt.clouddn.com/avatar.png"
               alt="RY Lin" />
          <p class="site-author-name" itemprop="name">RY Lin</p>
           
              <p class="site-description motion-element" itemprop="description">努力活成你喜欢的样子</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">30</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">6</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/GloryLin0704" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">RY Lin</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("xFdbk7yQqTgp4x02upKx64T5-gzGzoHsz", "0K2w4z8XKlmJhIDXKiAla2ES");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

</body>
</html>
